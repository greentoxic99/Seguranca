// Payload para testar a poluição do protótipo
//Você pode digitar no console do navegador

const maliciousData = {
  __proto__: {
    isAdmin: true
  }
};

// Verifica se o protótipo foi poluído ANTES de usar o DataTables
if (Object.prototype.isAdmin === undefined) {
  console.log("Protótipo limpo antes do teste.");
} else {
  console.log("Protótipo já poluído antes do teste. Verifique outras dependências.");
}

// Simula a passagem de dados para o DataTables
$(document).ready(function() {
  $('#example').DataTable({
    data: [maliciousData],
    columns: [
      { title: "Name", data: "name" },
      { title: "Position", data: "position" },
      { title: "Office", data: "office" },
      { title: "Age", data: "age" },
      { title: "Start date", data: "start_date" },
      { title: "Salary", data: "salary" }
    ]
  });
});

// Verifica se o protótipo foi poluído DEPOIS de usar o DataTables
setTimeout(() => {
  if (Object.prototype.isAdmin === true) {
    console.log("Vulnerável: Prototype Pollution detectado!");
  } else {
    console.log("Seguro: Nenhuma poluição do protótipo detectada.");
  }
}, 1000); // Aguarda 1 segundo para o DataTables processar os dados
